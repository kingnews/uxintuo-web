<!DOCTYPE html>
<html lang="en">

	<head>

		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="">
		<meta name="author" content="">

		<title>类型列表</title>

		<!-- Bootstrap Core CSS -->
		<link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

		<!-- MetisMenu CSS -->
		<link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

		<!--<!-- DataTables CSS -->
		<!--<link href="../vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet">-->

		<!-- DataTables Responsive CSS -->
		<link href="../vendor/datatables-responsive/dataTables.responsive.css" rel="stylesheet">
		<!-- Custom CSS -->
		<link href="../dist/css/sb-admin-2.css" rel="stylesheet">

		<!-- Custom Fonts -->
		<link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	</head>

	<body>
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12">
					<h1 class="page-header">产品列表</h1>
				</div>
				<!-- /.col-md-12 -->
			</div>
			<!-- /.row -->
			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-default">
						<div class="panel-heading">
							<div class="panel-title">
								产品列表
							</div>
						</div>
						<!-- /.panel-heading -->
						<div class="panel-body">
							<div class="container-fluid">
								<div class="row">
									<div class="col-md-10">
										<div class="col-md-1"><label class="control-label">产品类型：</label></div>
										<div class="col-md-2">
											<select class="form-control" id="searchType">
												<option value="-1">---请选择---</option>
											</select>
										</div>
										<div class="col-md-1"><label class="control-label">投资领域：</label></div>
										<div class="col-md-2">
											<select class="form-control" id="investmentAreasSearch">
												<option value="-1">---请选择---</option>
											</select>
										</div>
									</div>
									<div class="col-md-2">
										<button class="btn btn-success" type="button" id="addProudBut">
									添加
									</button>
									</div>
								</div>
								<div class="row">
									<table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
										<thead>
											<tr>
												<th>
													<input type="checkbox" name="cb-check-all">
												</th>
												<th>id</th>
												<th>产品名称</th>
												<th>产品类型</th>
												<th>投资领域</th>
												<th>状态</th>
												<th>投资期限</th>
												<th>是否推荐</th>
												<th>是否热门</th>
												<th>人气点击</th>
												<th>起投资金</th>
												<th>创建时间</th>
												<th>更新时间</th>
												<th>操作</th>
											</tr>
										</thead>
										<tbody>

										</tbody>
										<tfoot>
											<tr>

											</tr>
										</tfoot>
									</table>
								</div>

							</div>

						</div>
						<!-- /.panel-body -->
					</div>
					<!-- /.panel -->
				</div>

			</div>
			<!-- /#wrapper -->
		</div>
		<div class="container" id="view" style="display: none">
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品名称：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="titleView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品类型：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="typeView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资领域：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="investmentAreasView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">状态：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="statusView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">期限(月)：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="termView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">规模：</label></div>
				<div class="col-md-10"><textarea readonly class="form-control" id="scaleView"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">利息方式：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="interestView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资起点(万)：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="pnvestmentPointView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">收益：</label></div>
				<div class="col-md-10"><textarea readonly class="form-control" id="incomeIntroView"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最低收益：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="minIncomeView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最高收益：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="maxIncomeView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">募集账号：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="raiseAccountView" readonly></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">融资主体：</label></div>
				<div class="col-md-10"><textarea readonly class="form-control" id="financingSubjectView"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">资金用途：</label></div>
				<div class="col-md-10"><textarea readonly class="form-control" id="useOfFundsView"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">还款来源：</label></div>
				<div class="col-md-10"><textarea readonly class="form-control" id="paymentSourceView"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">风控措施：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="riskControlView" readonly></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">项目亮点：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="projectHighlightsView" readonly></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否热门：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="isHotView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否推荐：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="isRecommendView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">人气点击：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="popularCountView"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">创建时间：</label></div>
				<div class="col-md-10"><input type="text" readonly class="form-control" id="createTimeView"></div>
			</div>
		</div>

		<div class="container" id="editView" style="display: none;">
			<div class="row">
				<div class="col-md-2"><label class="control-label">id：</label></div>
				<div class="col-md-10"><input type="text" class="form-control" id="idEdit" readonly></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品名称：</label></div>
				<div class="col-md-10"><input type="text" class="form-control" id="titleEdit"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品类型：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="typeEdit">
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资领域：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="investmentAreasEdit">
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">状态：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="statusEdit">
						<option value="1">在售</option>
						<option value="2">售罄</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">期限(月)：</label></div>
				<div class="col-md-10"><input type="text" class="form-control" id="termEdit" onkeyup="this.value=this.value.replace(/[^0-9\+\/]/,'')"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">规模：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="scaleEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">利息方式：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="interestEdit">
						<option value="按月付息">按月付息</option>
						<option value="按季付息">按季付息</option>
						<option value="半年付息">半年付息</option>
						<option value="年付息">年付息</option>
						<option value="到期付息">到期付息</option>
						<option value="其他">其他</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资起点(万)：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="pnvestmentPointEdit"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">收益：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="incomeIntroEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最低收益%：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="minIncomeEdit"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最高收益%：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="maxIncomeEdit"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">募集账号：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="raiseAccountEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">融资主体：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="financingSubjectEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">资金用途：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="useOfFundsEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">还款来源：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="paymentSourceEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">风控措施：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="riskControlEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">项目亮点：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="projectHighlightsEdit"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否热门：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="isHotEdit">
						<option value="0">否</option>
						<option value="1">是</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否推荐：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="isRecommendEdit">
						<option value="0">否</option>
						<option value="1">是</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">人气点击：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="popularCountEdit"></div>
			</div>
			<div class="row">
				<div class="col-md-6"></div>
				<div class="col-md-6"><input type="button" class="btn btn-success" value="修改" id="editSub"></div>
			</div>
		</div>

		<div class="container" id="addView" style="display: none;">
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品名称：</label></div>
				<div class="col-md-10"><input type="text" class="form-control" id="titleAdd"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">产品类型：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="typeAdd">
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资领域：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="investmentAreasAdd">
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">状态：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="statusAdd">
						<option value="1">在售</option>
						<option value="2">售罄</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">期限(月)：</label></div>
				<div class="col-md-10"><input type="text" class="form-control" id="termAdd" onkeyup="this.value=this.value.replace(/[^0-9\+\/]/,'')"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">规模：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="scaleAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">利息方式：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="interestAdd">
						<option value="按月付息">按月付息</option>
						<option value="按季付息">按季付息</option>
						<option value="半年付息">半年付息</option>
						<option value="年付息">年付息</option>
						<option value="到期付息">到期付息</option>
						<option value="其他">其他</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">投资起点(万)：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="pnvestmentPointAdd"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">收益：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="incomeIntroAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最低收益%：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="minIncomeAdd"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">最高收益%：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="maxIncomeAdd"></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">募集账号：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="raiseAccountAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">融资主体：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="financingSubjectAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">资金用途：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="useOfFundsAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">还款来源：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="paymentSourceAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">风控措施：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="riskControlAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">项目亮点：</label></div>
				<div class="col-md-10"><textarea class="form-control" id="projectHighlightsAdd"></textarea></div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否热门：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="isHotAdd">
						<option value="0">否</option>
						<option value="1">是</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">是否推荐：</label></div>
				<div class="col-md-10">
					<select class="form-control" id="isRecommendAdd">
						<option value="0">否</option>
						<option value="1">是</option>
					</select>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2"><label class="control-label">人气点击：</label></div>
				<div class="col-md-10"><input type="number" class="form-control" id="popularCountAdd"></div>
			</div>
			<div class="row">
				<div class="col-md-6"></div>
				<div class="col-md-6"><input type="button" class="btn btn-success" value="修改" id="addSub"></div>
			</div>
		</div>
		<!-- jQuery -->
		<script src="../vendor/jquery/jquery.min.js"></script>

		<!-- Bootstrap Core JavaScript -->
		<script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

		<!-- Metis Menu Plugin JavaScript -->
		<script src="../vendor/metisMenu/metisMenu.min.js"></script>

		<!-- DataTables JavaScript -->
		<script src="../vendor/datatables/js/jquery.dataTables.min.js"></script>
		<script src="../vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
		<script src="../vendor/datatables-responsive/dataTables.responsive.js"></script>
		<!-- Custom Theme JavaScript -->
		<script src="../dist/js/sb-admin-2.js"></script>
		<script src="../js/layer.js"></script>
		<script src="../js/jquery.cookie.js"></script>
		<script src="../js/config.js"></script>
		<script src="../js/wangEditor.min.js"></script>
		<!-- Page-Level Demo Scripts - Tables - Use for reference -->
		<script>
			/*常量*/
			var CONSTANT = {
				DATA_TABLES: {
					DEFAULT_OPTION: { //DataTables初始化选项
						language: {
							"sProcessing": "处理中...",
							"sLengthMenu": "每页 _MENU_ 项",
							"sZeroRecords": "没有匹配结果",
							"sInfo": "当前显示第 _START_ 至 _END_ 项，共 _TOTAL_ 项。",
							"sInfoEmpty": "当前显示第 0 至 0 项，共 0 项",
							"sInfoFiltered": "(由 _MAX_ 项结果过滤)",
							"sInfoPostFix": "",
							"sSearch": "搜索:",
							"sUrl": "",
							"sEmptyTable": "表中数据为空",
							"sLoadingRecords": "载入中...",
							"sInfoThousands": ",",
							"oPaginate": {
								"sFirst": "首页",
								"sPrevious": "上页",
								"sNext": "下页",
								"sLast": "末页",
								"sJump": "跳转"
							},
							"oAria": {
								"sSortAscending": ": 以升序排列此列",
								"sSortDescending": ": 以降序排列此列"
							}
						},
						autoWidth: false, //禁用自动调整列宽
						stripeClasses: ["odd", "even"], //为奇偶行加上样式，兼容不支持CSS伪类的场合
						order: [], //取消默认排序查询,否则复选框一列会出现小箭头
						processing: true, //隐藏加载提示,自行处理
						serverSide: false, //启用服务器端分页
						searching: false //禁用原生搜索
					},
					COLUMN: {
						CHECKBOX: { //复选框单元格
							className: "td-checkbox",
							orderable: false,
							width: "30px",
							data: null,
							render: function(data, type, row, meta) {
								return '<input type="checkbox" class="iCheck">';
							}
						}
					},
					RENDER: { //常用render可以抽取出来，如日期时间、头像等
						ELLIPSIS: function(data, type, row, meta) {
							data = data || "";
							return '<span title="' + data + '">' + data + '</span>';
						}
					}
				}
			};
			$(document).ready(function() {
				var $table = $('#dataTables-example');
				var _table = $table.DataTable({
					responsive: true,
					language: CONSTANT.DATA_TABLES.DEFAULT_OPTION.language,
					autoWidth: false, //禁用自动调整列宽
					stripeClasses: ["odd", "even"], //为奇偶行加上样式，兼容不支持CSS伪类的场合
					order: [], //取消默认排序查询,否则复选框一列会出现小箭头
					processing: true, //隐藏加载提示,自行处理
					serverSide: true, //启用服务器端分页
					searching: true, //禁用原生搜索
					iDisplayLength: 10, //默认每页数量
					bSort: false, //排序功能
					lengthChange: false, //是否允许用户自定义显示数量
					ajax: function(data, callback, settings) {
						var page = data.start / data.length + 1;
						var title = data.search.value
						var type = $("#searchType").val();
						var investmentAreas = $("#investmentAreasSearch").val()
						if(type == -1) {
							type = null;
						}
						if(investmentAreas == -1){
							investmentAreas=null
						}
						$.ajax({
							url: API_PATH + "/admin/product/list",
							data: {
								pageNum: page,
								pageSize: data.length,
								title: title,
								typeId: type,
								investmentAreasId:investmentAreas
							},
							dataType: "json",
							success: function(jsonData) {
								if(jsonData.error == false) {
									var returnData = {};
									var arr = jsonData.data.records;
									var total = jsonData.data.total;
									returnData.recordsTotal = total;
									returnData.recordsFiltered = total
									returnData.draw = data.draw
									var tabelData = new Array();
									returnData.data = arr;
									callback(returnData)
								}
							}
						});
					},
					columns: [
						CONSTANT.DATA_TABLES.COLUMN.CHECKBOX,
						{
							className: "ellipsis", //文字过长时用省略号显示，CSS实现
							data: "id",
							render: CONSTANT.DATA_TABLES.RENDER.ELLIPSIS, //会显示省略号的列，需要用title属性实现划过时显示全部文本的效果
							width: "5px",
						},
						{
							className: "ellipsis",
							data: "title",
							render: CONSTANT.DATA_TABLES.RENDER.ELLIPSIS,
							//固定列宽，但至少留下一个活动列不要固定宽度，让表格自行调整。不要将所有列都指定列宽，否则页面伸缩时所有列都会随之按比例伸缩。
							//切记设置table样式为table-layout:fixed; 否则列宽不会强制为指定宽度，也不会出现省略号。
							width: "80px",
						},
						{
							data: "typeName",
							width: "80px",
						},
						{
							data: "investmentAreasName",
							width: "10px",
						},
						{
							data: "status",
							width: "8px",
							render: function(data, type, row, meta) {
								return(data == 1 ? "在售" : "售罄");
							}
						},
						{
							data: "term",
							width: "40px",
						},
						{
							data: "isRecommend",
							width: "8px",
							render: function(data, type, row, meta) {
								return(data == 1 ? "是" : "否");
							}
						},
						{
							data: "isHot",
							width: "8px",
							render: function(data, type, row, meta) {
								return(data == 1 ? "是" : "否");
							}
						},
						{
							data: "popularCount",
							width: "10px",
						},
						{
							data: "pnvestmentPoint",
							width: "10px",
						},
						{
							data: "createTime",
							render: function(data, type, row, meta) {
								var newDate = new Date();
								newDate.setTime(data);
								return newDate.toLocaleString();
							},
							width: "40px",
						},
						{
							data: "modifyTime",
							render: function(data, type, row, meta) {
								var newDate = new Date();
								newDate.setTime(data);
								return newDate.toLocaleString();
							},
							width: "40px",
						},
						{
							className: "td-operation",
							data: null,
							defaultContent: "",
							orderable: false,
							width: "120px"
						}
					],
					createdRow: function(row, data, index) {     
						var $btn = $('<button type="button" class="btn btn-small btn-info btn-details">详情</button>');             
						var $btnEdit = $('<button type="button" class="btn btn-small btn-primary btn-edit">修改</button>');            
						var $btnDel = $('<button type="button" class="btn btn-small btn-danger btn-del">删除</button>');            
						$('td', row).eq(13).append($btn).append($btnEdit).append($btnDel);         
					},
					initComplete: function() {
						this.api().columns().every(function() {
							var column = this;
							var select = $('<select><option value=""></option></select>')
								.appendTo($(column.footer()).empty())
								.on('change', function() {
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);

									column.search(val ? '^' + val + '$' : '', true, false)
										.draw();
								});

							column.data().unique().sort().each(function(d, j) {
								select.append('<option value="' + d + '">' + d + '</option>')
							});
						});
					}
				});

				$table.on("change", ":checkbox", function() {
					if($(this).is("[name='cb-check-all']")) {
						//全选
						$(":checkbox", $table).prop("checked", $(this).prop("checked"));
					} else {
						//一般复选
						var checkbox = $("tbody :checkbox", $table);
						$(":checkbox[name='cb-check-all']", $table).prop('checked', checkbox.length == checkbox.filter(':checked').length);
					}
				}).on("click", ".td-checkbox", function(event) {
					//点击单元格即点击复选框
					!$(event.target).is(":checkbox") && $(":checkbox", this).trigger("click");
				}).on("click", ".btn-edit", function() {
					//点击编辑按钮
					var item = _table.row($(this).closest('tr')).data();
					$(this).closest('tr').addClass("active").siblings().removeClass("active");
					userManage.currentItem = item;
					userManage.editItemInit(item);
				}).on("click", ".btn-del", function() {
					//点击删除按钮
					var item = _table.row($(this).closest('tr')).data();
					$(this).closest('tr').addClass("active").siblings().removeClass("active");
					userManage.deleteItem([item]);
				}).on("click", ".btn-details", function() {
					//点击详情按钮
					var item = _table.row($(this).closest('tr')).data();
					$(this).closest('tr').addClass("active").siblings().removeClass("active");
					userManage.showItemDetail([item]);
				});

				$('#dataTables-example tbody').on('click', 'tr', function() {
					$(this).toggleClass('selected');
				});

				$('#button').click(function() {
					table.row('.selected').remove().draw(false);
				});
				typeList();
				investmentAreasList();
				$("#editSub").click(function() {
					userManage.editItemSubmit()
				})
				$("#addSub").click(function() {
					userManage.addItemSubmit();
				})
				$("#addProudBut").click(function() {
					userManage.addItemInit();
				})
				var userManage = {
					currentItem: null,
					fuzzySearch: true,
					getQueryCondition: function(data) {
						var param = {};
						//组装排序参数
						if(data.order && data.order.length && data.order[0]) {
							switch(data.order[0].column) {
								case 1:
									param.orderColumn = "name";
									break;
								case 2:
									param.orderColumn = "position";
									break;
								case 3:
									param.orderColumn = "status";
									break;
								case 4:
									param.orderColumn = "start_date";
									break;
								default:
									param.orderColumn = "name";
									break;
							}
							param.orderDir = data.order[0].dir;
						}
						//组装查询参数
						param.fuzzySearch = userManage.fuzzySearch;
						if(userManage.fuzzySearch) {
							param.fuzzy = $("#fuzzy-search").val();
						} else {
							param.name = $("#name-search").val();
							param.position = $("#position-search").val();
							param.office = $("#office-search").val();
							param.extn = $("#extn-search").val();
							param.status = $("#status-search").val();
							param.role = $("#role-search").val();
						}
						//组装分页参数
						param.startIndex = data.start;
						param.pageSize = data.length;

						return param;
					},
					showItemDetail: function(item) {
						layer.open({
							type: 1,
							title: "详情",
							area: '1500px',
							shadeClose: true,
							content: $('#view')
						});
						var d = item[0]
						$("#titleView").val(d.title);
						$("#investmentAreasView").val(d.investmentAreasName);
						$("#statusView").val(d.status == 1 ? "在售" : "售罄");
						$("#typeView").val(d.typeName);
						$("#pnvestmentPointView").val(d.pnvestmentPoint)
						$("#popularCountView").val(d.popularCount)
						$("#isHotView").val(d.isHot == 1 ? "是" : "否");
						$("#isRecommendView").val(d.isRecommend == 1 ? "是" : "否")
						var newDate = new Date();
						newDate.setTime(d.createTime);
						$("#createTimeView").val(newDate.toLocaleString())
						$("#minIncomeView").val(d.minIncome)
						$("#maxIncomeView").val(d.maxIncome)
						$("#scaleView").val(d.scale)
						$("#incomeIntroView").val(d.incomeIntro)
						$("#useOfFundsView").val(d.useOfFunds)
						$("#paymentSourceView").val(d.paymentSource)
						$("#financingSubjectView").val(d.financingSubject)
						$("#termView").val(d.term);
						$("#interestView").val(d.interest);
						$("#riskControlView").val(d.riskControl)
						$("#raiseAccountView").val(d.raiseAccount)
						$("#projectHighlightsView").val(d.projectHighlights)
					},
					addItemInit: function() {
						layer.open({
							type: 1,
							title: "添加",
							area: '1500px',
							shadeClose: true,
							content: $('#addView')
						});
					},
					editItemInit: function(d) {
						if(!d) {
							return;
						}
						layer.open({
							type: 1,
							title: "编辑",
							area: '1500px',
							shadeClose: true,
							content: $('#editView')
						});
						$("#idEdit").val(d.id)
						$("#titleEdit").val(d.title);
						$("#investmentAreasEdit").val(d.investmentAreasId)
						$("#statusEdit").val(d.status);
						$("#typeEdit").val(d.typeId);
						$("#pnvestmentPointEdit").val(d.pnvestmentPoint)
						$("#popularCountEdit").val(d.popularCount)
						$("#isHotEdit").val(d.isHot)
						$("#isRecommendEdit").val(d.isRecommend)
						var newDate = new Date();
						newDate.setTime(d.createTime);
						$("#createTimeEdit").val(newDate.toLocaleString())
						$("#minIncomeEdit").val(d.minIncome)
						$("#maxIncomeEdit").val(d.maxIncome)
						$("#scaleEdit").val(d.scale)
						$("#incomeIntroEdit").val(d.incomeIntro)
						$("#useOfFundsEdit").val(d.useOfFunds)
						$("#paymentSourceEdit").val(d.paymentSource)
						$("#financingSubjectEdit").val(d.financingSubject)
						$("#termEdit").val(d.term);
						$("#interestEdit").val(d.interest);
						$("#riskControlEdit").val(d.riskControl)
						$("#raiseAccountEdit").val(d.raiseAccount)
						$("#projectHighlightsEdit").val(d.projectHighlights)
					},
					addItemSubmit: function() {
						var l = layer.load();
						var data = {};
						data.title = $("#titleAdd").val();
						data.investmentAreasId = $("#investmentAreasAdd").val();
						data.status = $("#statusAdd").val();
						data.typeId = $("#typeAdd").val();
						data.pnvestmentPoint = $("#pnvestmentPointAdd").val()
						data.popularCount = $("#popularCountAdd").val()
						data.isHot = $("#isHotAdd").val() == 1 ? true : false
						data.isRecommend = $("#isRecommendAdd").val() == 1 ? true : false
						data.minIncome = $("#minIncomeAdd").val()
						data.maxIncome = $("#maxIncomeAdd").val()
						data.scale = $("#scaleAdd").val()
						data.incomeIntro = $("#incomeIntroAdd").val()
						data.useOfFunds = $("#useOfFundsAdd").val()
						data.paymentSource = $("#paymentSourceAdd").val()
						data.financingSubject = $("#financingSubjectAdd").val()
						data.term = $("#termAdd").val();
						data.interest = $("#interestAdd").val();
						data.riskControl = $("#riskControlAdd").val()
						data.raiseAccount = $("#raiseAccountAdd").val()
						data.projectHighlights = $("#projectHighlightsAdd").val()
						addProduct(data);
						layer.close(l);
						$table.ajax.reload()
					},
					editItemSubmit: function() {
						var l = layer.load();
						var data = {}
						data.id = $("#idEdit").val()
						data.title = $("#titleEdit").val();
						data.investmentAreasId = $("#investmentAreasEdit").val();
						data.status = $("#statusEdit").val();
						data.typeId = $("#typeEdit").val();
						data.pnvestmentPoint = $("#pnvestmentPointEdit").val()
						data.popularCount = $("#popularCountEdit").val()
						data.isHot = $("#isHotEdit").val() == 1 ? true : false
						data.isRecommend = $("#isRecommendEdit").val() == 1 ? true : false
						data.minIncome = $("#minIncomeEdit").val()
						data.maxIncome = $("#maxIncomeEdit").val()
						data.scale = $("#scaleEdit").val()
						data.incomeIntro = $("#incomeIntroEdit").val()
						data.useOfFunds = $("#useOfFundsEdit").val()
						data.paymentSource = $("#paymentSourceEdit").val()
						data.financingSubject = $("#financingSubjectEdit").val()
						data.term = $("#termEdit").val();
						data.interest = $("#interestEdit").val();
						data.riskControl = $("#riskControlEdit").val()
						data.raiseAccount = $("#raiseAccountEdit").val()
						data.projectHighlights = $("#projectHighlightsEdit").val()
						updateProduct(data);
						layer.close(l);

					},
					deleteItem: function(selectedItems) {
						var message;
						if(selectedItems && selectedItems.length) {
							if(selectedItems.length == 1) {
								message = "确定要删除 '" + selectedItems[0].title + "' 吗?";

							} else {
								message = "确定要删除选中的" + selectedItems.length + "项记录吗?";
							}
							layer.confirm(message, {
								icon: 3,
								title: '删除'
							}, function(index) {
								$.ajax({
									url: API_PATH + "/admin/product/del",
									data: {
										id: selectedItems[0].id,
									},
									dataType: "json",
									success: function(data) {
										if(data.error == false) {
											layer.msg("成功！");
											_table.ajax.reload()
										}
										layer.close(index);
									}
								});
							});
						} else {
							layer.msg("请选中要删除的对象！");
						}
					}
				};

				function typeList() {
					$.ajax({
						url: API_PATH + "/admin/category/list",
						data: {
							pageNum: 1,
							pageSize: 100,
							parentId: 3
						},
						success: function(data) {
							if(data.error == false) {
								for(i = 0; i < data.data.records.length; i++) {
									$("#typeEdit").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
									$("#typeAdd").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
									$("#searchType").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
								}
							}
						}
					})
				}

				function investmentAreasList() {
					$.ajax({
						url: API_PATH + "/admin/category/list",
						data: {
							pageNum: 1,
							pageSize: 100,
							parentId: 1
						},
						success: function(data) {
							if(data.error == false) {
								for(i = 0; i < data.data.records.length; i++) {
									$("#investmentAreasEdit").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
									$("#investmentAreasAdd").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
									$("#investmentAreasSearch").append("<option value='" + data.data.records[i].id + "'>" + data.data.records[i].name + "</option>")
								}
							}
						}
					})
				}

				function addProduct(d) {
					$.ajax({
						url: API_PATH + "/admin/product/add",
						data: d,
						type: "post",
						success: function(data) {
							if(data.error == false) {
								layer.msg("成功！")
								_table.ajax.reload()
							} else {
								layer.msg(data.message)
							}
						}
					})
				}

				function updateProduct(d) {
					$.ajax({
						url: API_PATH + "/admin/product/update",
						data: d,
						type: "post",
						success: function(data) {
							if(data.error == false) {
								layer.msg("成功！")
								_table.ajax.reload()
							} else {
								layer.msg(data.message)
							}
						}
					})
				}
				$("select#searchType").change(function() {
					_table.ajax.reload();
				});
				$("select#investmentAreasSearch").change(function() {
					_table.ajax.reload();
				});
			});
		</script>

	</body>

</html>